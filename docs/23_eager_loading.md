# Eager ローディング
N+1問題の回避のための機能  
データの取得の負荷や転送量を減らすため、リレーション先のレコードは実際に呼び出されるまでデータベースから取り出さないようになっている  
コントローラやビューで取り出したときにはじめてSQLを発行してデータを取り出す  
そのため、一覧画面などでリレーション先のテーブルのレコードを多数取得する場面ではクエリの実行回数が多くなり、  
オーバーヘッドが大きくなって性能に影響を与えることになる  
これを回避するため、指定のリレーションのデータをあらかじめ取得しておき、SQLクエリの追加実行をせずにリレーション先テーブルのレコードを取得できるようにする  
このようなSQLへのアクセス方法をEagerロードという

## Eloquant におけるEagerロード
モデルのメソッド`with(リレーションメソッド名)` で、指定のリレーションのレコードをあらかじめロードしておくことができる  
例: dogs belongs to a owner のリレーションがモデルに設定されている場合
```
/* dogs テーブルのレコードを、リレーション先のowner テーブルに連携するレコードのデータを含めて取得する */
App\Models\Dog::with('owner')->all();

/* with() なしの場合、owner のレコードの情報は含まれない */
```

## リレーション先のリレーションを取得する
`with('relation_1.relation_2')` のように、ドット記法でリレーション先のリレーションも取得できる  
ドットの左側のレコードも取り出されるので、リレーションが遠いとそれだけ取得するデータも大きくなって負荷になる  
リレーションが遠い場合は、リレーションのチェインが多くなって見づらいので、2回に分けることも検討する


## 参考
- Eagerロード 8.x Laravel:
  https://readouble.com/laravel/8.x/ja/eloquent-relationships.html#eager-loading
