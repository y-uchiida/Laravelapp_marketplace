# マルチログインの実装

## Authenticatable
Authenticatable を継承することで、Authに関する機能が利用できるようになる  
デフォルトで生成されるUserモデルはこれを継承している  
さらに、User モデルでは追加的な動作が設定されているので、それも利用する

## モデルの作成、マイグレーションの設定
`php artisan make:model {モデル名} -m`  
`-m` で、マイグレーションファイルも一緒に生成する  
マイグレーションファイル名は`create_{モデルに対応するテーブル名}_table` になる

マイグレーションファイルだけ作成する場合は、
`php artisan make:migration {マイグレーションファイル名}`

## パスワードリセット用のテーブルを作成
User モデルは、パスワードリセットのテーブルと持っているので、これも追加する  

## 認証用のルーティングの設定
require されたauth.php が丸ごと認証のためのルーティングを設定している  
これもUser モデルように設定されたものなので、OwnerとAdminで利用できるように変更する  
すべてweb.php に記述すると、肥大化してしまうので、`route/owner.php` と`rpute/admin.php` を作って、  
それぞれのルーティングの記述はそちらに分ける

## RouteServiceProvider
ルーティングに関する設定を取りまとめて行ってくれるサービスプロバイダ  
`app/Providers/RouteServiceProvider` にある  

まずは、各ユーザー種別ごとのhomeのURLを定数で設定  
また、認証種別ごとに読み込みするファイルを切り分けるため、ルーティング設定も変更する

## ガードの設定
Readouble より引用
> Laravelの認証機能は、基本的に「ガード」と「プロバイダ」で構成されています。ガードは、リクエストごとにユーザーを認証する方法を定義します。
> たとえば、Laravelには、セッションストレージとクッキーを使用して状態を維持する「セッション」ガードを用意しています。

> プロバイダは、永続ストレージからユーザーを取得する方法を定義します。LaravelはEloquentとデータベースクエリビルダを使用してユーザーを取得するためのサポートを用意しています。
> ただし、アプリケーションの必要性に応じて、追加のプロバイダを自由に定義できます。

`config/auth.php` の`guard`に、admin と ownerの設定を追加する
