# Laravelのサービスコンテナ

## サービスコンテナ = なんでも入っている道具箱
bootstrap.php で追加されたサービスがここにまとめて保持される  
サービスコンテナから、これらのサービスを素早く取り出して利用することができる

## $app
`bootstrap/app.php` でインスタンス化されているApplicationクラスのオブジェクト
```
$app = new Illuminate\Foundation\Application(
    $_ENV['APP_BASE_PATH'] ?? dirname(__DIR__)
);
```
この中の、bindingsに、サービスがぶら下がっている


## サービスコンテナへのサービスの追加
```
# 関数を登録する
app()->bind({登録するサービスの名称}, function(){});

# クラスを登録する
app()->make({登録するサービスの名称}, {クラス名}::class);
```

## サービスコンテナからサービス(のインスタンス)を取得する
```
app()->make({サービス名});
```

## サービスコンテナの利点: DI
サービスのクラスのコンストラクタの引数にクラスのインスタンスが入っていると、それを自動的にインスタンス化して渡してくれる  
サービスコンテナの外側でインスタンス化して、それをコンストラクタに渡す必要がない
```
$d = new depended(); /* depended クラスのインスタンスが必要な場合、先にインスタンス化しておき、 */
$obj = new test($d) /* こんな感じにインスタンスを引き渡さないといけない */

$obj_2 = app()->make('test'); /* サービスクラスとしてコンテナに入れておくと、内部の依存関係を解決してくれる */
```
